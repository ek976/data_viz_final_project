---
title: "Global study of Gender Inequality in Education Access"
authors: "Jorge Bris Moreno, Liz Kovalchuk, Tiana Le, and Sheeba Moghal"
format:
  html:
    embed-resources: true
    toc: true
editor_options:
  chunk_output_type: console
execute:
  echo: false
---

```{r} 
#| label: common-setup
#| echo: false 
#| warning: false 
#library(reticulate)
#py_install("plotly")
#use_condaenv("/opt/homebrew/Caskroom/miniconda/base", required = TRUE) 
``` 

# Abstract
In this article we aim to explore gender inequality in education access across the globe. Education is one of the key drivers in the development of society. Using data obtained from the World Bank, our team analyzed the relationship between education attainment, gender, and other economic factors such as Gross Domestic Product (GDP), the Gross National Income (GNI) index, population, and other variables. The data utilized is from the years 2010, 2011, 2012, 2013, and 2014. This project focuses on a larger global scale and then provides the interactivity for readers to dive into specific regions, countries, and demographics in order to identify trends and patterns. We hope that you find this dataset as interesting and expository as we did - from regions with the highest diparity in education enrollment based on gender to the linkage of other factors that may be contributing to this disparity encourages us to ask questions about the forces at play (economic, political, social) affecting women's access to education and thus to a better life.


# Introduction
Education is one of the most important factors in the development of society. Throughout all history, women have been marginalized in the education system. This has led to a significant gap in the education. The United Nations has recognized this issue and has emphasized the importance of education in the sustainable development of society. While this gender gap has been closing over the years, we will aim to explore the current state of this gap and what are the factors that may be contributing to its continued existence so that we can better understand how to address this issue. 

To do this, we will not only take into account factors like global development or macroeconomics but we will try to dive deeper into gender roles in society.  We will address six critical questions:

- How do literacy rates correlate with population growth rates across different regions and time periods?
- How does the allocation of resources to education influence literacy rates?
-  In what ways do literacy and education contribute to economic growth and development?
- To what extent does gender equality manifest in educational access, participation, and outcomes?
- How do trends in education mirror trends in employment, particularly regarding gender?
- What specific obstacles hinder gender equality in educational access, retention, and achievement? 

By answering the above, we will be able to find out the importance of education in the development of countries and population, the influence it has within the working industry, what role economics plays in education, and explore further issues in the current gender gap. Hopefully, this study will help us better understand this gap and how to address it in the future.

# Regions
Before analyzing the world, it is important to understand its nature. Analyzing the whole world can be overwhelming at times, due to its complexity and number of countries in it. For that reason, we need to understand how to divide it. The world Bank does a great job dividing it into 7 different regions: South Asia, Europe & Central Asia, Latin America & Caribbean, Middle East & North Africa, East Asia & Pacific, Sub-Saharan Africa, and North America. We can see this division here:
```{r, echo=FALSE, results='asis', runtime="js"}
# data from here: https://ourworldindata.org/grapher/world-regions-according-to-the-world-bank?tab=table

# Calling highcharts
cat('
<script src="https://code.highcharts.com/maps/highmaps.js"></script>
<script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
<script src="https://code.highcharts.com/maps/modules/accessibility.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-more.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
')
```

<figure>
  <div id="container1" style="width: 100%; height: 500px;"></div>
  <figcaption>This is a map of the classification of regions provided by the World Bank. Each country is colored by the region they are in, the numbers are insicators for each region, and you can zoom in and out with the + and - bottons, as well as move around the map by clicking and dragging.</figcaption>
</figure>

<script>
// load data and highcharts topology
(async () => {
    // Fetch the topology data for the world map
    let topology = await fetch('https://code.highcharts.com/mapdata/custom/world.topo.json')
        .then(response => response.json());

    let regions = [
  {
    "name": "AFG",
    "value": 1
  },
  {
    "name": "ALB",
    "value": 2
  },
  {
    "name": "DZA",
    "value": 4
  },
  {
    "name": "ASM",
    "value": 5
  },
  {
    "name": "AND",
    "value": 2
  },
  {
    "name": "AGO",
    "value": 6
  },
  {
    "name": "ATG",
    "value": 3
  },
  {
    "name": "ARG",
    "value": 3
  },
  {
    "name": "ARM",
    "value": 2
  },
  {
    "name": "ABW",
    "value": 3
  },
  {
    "name": "AUS",
    "value": 5
  },
  {
    "name": "AUT",
    "value": 2
  },
  {
    "name": "AZE",
    "value": 2
  },
  {
    "name": "BHS",
    "value": 3
  },
  {
    "name": "BHR",
    "value": 4
  },
  {
    "name": "BGD",
    "value": 1
  },
  {
    "name": "BRB",
    "value": 3
  },
  {
    "name": "BLR",
    "value": 2
  },
  {
    "name": "BEL",
    "value": 2
  },
  {
    "name": "BLZ",
    "value": 3
  },
  {
    "name": "BEN",
    "value": 6
  },
  {
    "name": "BMU",
    "value": 7
  },
  {
    "name": "BTN",
    "value": 1
  },
  {
    "name": "BOL",
    "value": 3
  },
  {
    "name": "BIH",
    "value": 2
  },
  {
    "name": "BWA",
    "value": 6
  },
  {
    "name": "BRA",
    "value": 3
  },
  {
    "name": "VGB",
    "value": 3
  },
  {
    "name": "BRN",
    "value": 5
  },
  {
    "name": "BGR",
    "value": 2
  },
  {
    "name": "BFA",
    "value": 6
  },
  {
    "name": "BDI",
    "value": 6
  },
  {
    "name": "KHM",
    "value": 5
  },
  {
    "name": "CMR",
    "value": 6
  },
  {
    "name": "CAN",
    "value": 7
  },
  {
    "name": "CPV",
    "value": 6
  },
  {
    "name": "CYM",
    "value": 3
  },
  {
    "name": "CAF",
    "value": 6
  },
  {
    "name": "TCD",
    "value": 6
  },
  {
    "name": "OWID_CIS",
    "value": 2
  },
  {
    "name": "CHL",
    "value": 3
  },
  {
    "name": "CHN",
    "value": 5
  },
  {
    "name": "COL",
    "value": 3
  },
  {
    "name": "COM",
    "value": 6
  },
  {
    "name": "COG",
    "value": 6
  },
  {
    "name": "CRI",
    "value": 3
  },
  {
    "name": "CIV",
    "value": 6
  },
  {
    "name": "HRV",
    "value": 2
  },
  {
    "name": "CUB",
    "value": 3
  },
  {
    "name": "CUW",
    "value": 3
  },
  {
    "name": "CYP",
    "value": 2
  },
  {
    "name": "CZE",
    "value": 2
  },
  {
    "name": "COD",
    "value": 6
  },
  {
    "name": "DNK",
    "value": 2
  },
  {
    "name": "DJI",
    "value": 4
  },
  {
    "name": "DMA",
    "value": 3
  },
  {
    "name": "DOM",
    "value": 3
  },
  {
    "name": "TLS",
    "value": 5
  },
  {
    "name": "ECU",
    "value": 3
  },
  {
    "name": "EGY",
    "value": 4
  },
  {
    "name": "SLV",
    "value": 3
  },
  {
    "name": "GNQ",
    "value": 6
  },
  {
    "name": "ERI",
    "value": 6
  },
  {
    "name": "EST",
    "value": 2
  },
  {
    "name": "SWZ",
    "value": 6
  },
  {
    "name": "ETH",
    "value": 6
  },
  {
    "name": "FRO",
    "value": 2
  },
  {
    "name": "FJI",
    "value": 5
  },
  {
    "name": "FIN",
    "value": 2
  },
  {
    "name": "FRA",
    "value": 2
  },
  {
    "name": "PYF",
    "value": 5
  },
  {
    "name": "GAB",
    "value": 6
  },
  {
    "name": "GMB",
    "value": 6
  },
  {
    "name": "GEO",
    "value": 2
  },
  {
    "name": "DEU",
    "value": 2
  },
  {
    "name": "GHA",
    "value": 6
  },
  {
    "name": "GIB",
    "value": 2
  },
  {
    "name": "GRC",
    "value": 2
  },
  {
    "name": "GRL",
    "value": 2
  },
  {
    "name": "GRD",
    "value": 3
  },
  {
    "name": "GUM",
    "value": 5
  },
  {
    "name": "GTM",
    "value": 3
  },
  {
    "name": "GIN",
    "value": 6
  },
  {
    "name": "GNB",
    "value": 6
  },
  {
    "name": "GUY",
    "value": 3
  },
  {
    "name": "HTI",
    "value": 3
  },
  {
    "name": "HND",
    "value": 3
  },
  {
    "name": "HKG",
    "value": 5
  },
  {
    "name": "HUN",
    "value": 2
  },
  {
    "name": "ISL",
    "value": 2
  },
  {
    "name": "IND",
    "value": 1
  },
  {
    "name": "IDN",
    "value": 5
  },
  {
    "name": "IRN",
    "value": 4
  },
  {
    "name": "IRQ",
    "value": 4
  },
  {
    "name": "IRL",
    "value": 2
  },
  {
    "name": "IMN",
    "value": 2
  },
  {
    "name": "ISR",
    "value": 4
  },
  {
    "name": "ITA",
    "value": 2
  },
  {
    "name": "JAM",
    "value": 3
  },
  {
    "name": "JPN",
    "value": 5
  },
  {
    "name": "JOR",
    "value": 4
  },
  {
    "name": "KAZ",
    "value": 2
  },
  {
    "name": "KEN",
    "value": 6
  },
  {
    "name": "KIR",
    "value": 5
  },
  {
    "name": "OWID_KOS",
    "value": 2
  },
  {
    "name": "KWT",
    "value": 4
  },
  {
    "name": "KGZ",
    "value": 2
  },
  {
    "name": "LAO",
    "value": 5
  },
  {
    "name": "LVA",
    "value": 2
  },
  {
    "name": "LBN",
    "value": 4
  },
  {
    "name": "LSO",
    "value": 6
  },
  {
    "name": "LBR",
    "value": 6
  },
  {
    "name": "LBY",
    "value": 4
  },
  {
    "name": "LIE",
    "value": 2
  },
  {
    "name": "LTU",
    "value": 2
  },
  {
    "name": "LUX",
    "value": 2
  },
  {
    "name": "MAC",
    "value": 5
  },
  {
    "name": "MDG",
    "value": 6
  },
  {
    "name": "MWI",
    "value": 6
  },
  {
    "name": "MYS",
    "value": 5
  },
  {
    "name": "MDV",
    "value": 1
  },
  {
    "name": "MLI",
    "value": 6
  },
  {
    "name": "MLT",
    "value": 4
  },
  {
    "name": "MHL",
    "value": 5
  },
  {
    "name": "MRT",
    "value": 6
  },
  {
    "name": "MUS",
    "value": 6
  },
  {
    "name": "MEX",
    "value": 3
  },
  {
    "name": "",
    "value": 5
  },
  {
    "name": "MDA",
    "value": 2
  },
  {
    "name": "MCO",
    "value": 2
  },
  {
    "name": "MNG",
    "value": 5
  },
  {
    "name": "MNE",
    "value": 2
  },
  {
    "name": "MAR",
    "value": 4
  },
  {
    "name": "MOZ",
    "value": 6
  },
  {
    "name": "MMR",
    "value": 5
  },
  {
    "name": "NAM",
    "value": 6
  },
  {
    "name": "NRU",
    "value": 5
  },
  {
    "name": "NPL",
    "value": 1
  },
  {
    "name": "NLD",
    "value": 2
  },
  {
    "name": "NCL",
    "value": 5
  },
  {
    "name": "NZL",
    "value": 5
  },
  {
    "name": "NIC",
    "value": 3
  },
  {
    "name": "NER",
    "value": 6
  },
  {
    "name": "NGA",
    "value": 6
  },
  {
    "name": "PRK",
    "value": 5
  },
  {
    "name": "MKD",
    "value": 2
  },
  {
    "name": "MNP",
    "value": 5
  },
  {
    "name": "NOR",
    "value": 2
  },
  {
    "name": "OMN",
    "value": 4
  },
  {
    "name": "PAK",
    "value": 1
  },
  {
    "name": "PLW",
    "value": 5
  },
  {
    "name": "PSE",
    "value": 4
  },
  {
    "name": "PAN",
    "value": 3
  },
  {
    "name": "PNG",
    "value": 5
  },
  {
    "name": "PRY",
    "value": 3
  },
  {
    "name": "PER",
    "value": 3
  },
  {
    "name": "PHL",
    "value": 5
  },
  {
    "name": "POL",
    "value": 2
  },
  {
    "name": "PRT",
    "value": 2
  },
  {
    "name": "PRI",
    "value": 3
  },
  {
    "name": "QAT",
    "value": 4
  },
  {
    "name": "ROU",
    "value": 2
  },
  {
    "name": "RUS",
    "value": 2
  },
  {
    "name": "RWA",
    "value": 6
  },
  {
    "name": "KNA",
    "value": 3
  },
  {
    "name": "LCA",
    "value": 3
  },
  {
    "name": "MAF",
    "value": 3
  },
  {
    "name": "VCT",
    "value": 3
  },
  {
    "name": "WSM",
    "value": 5
  },
  {
    "name": "SMR",
    "value": 2
  },
  {
    "name": "STP",
    "value": 6
  },
  {
    "name": "SAU",
    "value": 4
  },
  {
    "name": "SEN",
    "value": 6
  },
  {
    "name": "SRB",
    "value": 2
  },
  {
    "name": "SYC",
    "value": 6
  },
  {
    "name": "SLE",
    "value": 6
  },
  {
    "name": "SGP",
    "value": 5
  },
  {
    "name": "SXM",
    "value": 3
  },
  {
    "name": "SVK",
    "value": 2
  },
  {
    "name": "SVN",
    "value": 2
  },
  {
    "name": "SLB",
    "value": 5
  },
  {
    "name": "SOM",
    "value": 6
  },
  {
    "name": "ZAF",
    "value": 6
  },
  {
    "name": "KOR",
    "value": 5
  },
  {
    "name": "SSD",
    "value": 6
  },
  {
    "name": "ESP",
    "value": 2
  },
  {
    "name": "LKA",
    "value": 1
  },
  {
    "name": "SDN",
    "value": 6
  },
  {
    "name": "SUR",
    "value": 3
  },
  {
    "name": "SWE",
    "value": 2
  },
  {
    "name": "CHE",
    "value": 2
  },
  {
    "name": "SYR",
    "value": 4
  },
  {
    "name": "TJK",
    "value": 2
  },
  {
    "name": "TZA",
    "value": 6
  },
  {
    "name": "THA",
    "value": 5
  },
  {
    "name": "TGO",
    "value": 6
  },
  {
    "name": "TON",
    "value": 5
  },
  {
    "name": "TTO",
    "value": 3
  },
  {
    "name": "TUN",
    "value": 4
  },
  {
    "name": "TUR",
    "value": 2
  },
  {
    "name": "TKM",
    "value": 2
  },
  {
    "name": "TCA",
    "value": 3
  },
  {
    "name": "TUV",
    "value": 5
  },
  {
    "name": "UGA",
    "value": 6
  },
  {
    "name": "UKR",
    "value": 2
  },
  {
    "name": "ARE",
    "value": 4
  },
  {
    "name": "GBR",
    "value": 2
  },
  {
    "name": "USA",
    "value": 7
  },
  {
    "name": "VIR",
    "value": 3
  },
  {
    "name": "URY",
    "value": 3
  },
  {
    "name": "UZB",
    "value": 2
  },
  {
    "name": "VUT",
    "value": 5
  },
  {
    "name": "VEN",
    "value": 3
  },
  {
    "name": "VNM",
    "value": 5
  },
  {
    "name": "YEM",
    "value": 4
  },
  {
    "name": "ZMB",
    "value": 6
  },
  {
    "name": "ZWE",
    "value": 6
  }
];
// Create the chart
    Highcharts.mapChart('container1', {
        chart: {
            map: topology
        },
        title: {
            text: 'World Map divided by Regions',
            align: 'left'
        },
        credits: {
            href: '',
            text: ''
        },
        mapNavigation: {
            enabled: true,
            buttonOptions: {
                verticalAlign: 'bottom'
            }
        },
        colorAxis: {
    dataClasses: [{
        from: 1,
        to: 2,
        color: '#3d6469',
        name: 'South Asia (1)'
    }, {
        from: 2,
        to: 3,
        color: '#ffa205',
        name: 'Europe & Central Asia (2)'
    }, {
        from: 3,
        to: 4,
        color: '#ff4500',
        name: 'Latin America & Caribbean (3)'
    }, {
        from: 4,
        to: 5,
        color: '#08030a',
        name: 'Middle East & North Africa (4)'
    }, {
        from: 5,
        to: 6,
color: '#feeece',
        name: 'East Asia & Pacific (5)'
    }, {
        from: 6,
        to: 7,
        color: '#d40637',
        name: 'Sub-Saharan Africa (6)'
    }, {
        from: 7,
        to: 8,
        color: '#5f0922',
        name: 'North America (7)'
    }]
        },
        series: [{
            name: 'Gross Enrolment Ratio',
            joinBy: ['iso-a3', 'name'],
            data: regions,
            dataLabels: {
                enabled: true,
                format: '{point.name}: {point.value}',
                style: {
                    fontWeight: 'normal'
                }
            }
        }]
    });
})();
</script>

This map is very useful for categorizing countries into regions. This regions have been selected by the World Bank due to their location and other similarities.

# Teasing out Enrollment by Region 

To begin our analysis, we will be looking at different regions usually studied by the World Bank and represented above. While this graph may not have a great impact in an analysis, we can see how higher level of education bubbles are smaller, specially the Tertiary level:

To begin our analysis, we will be looking at different regions usually studied by global organizations like the World Bank. We will be focusing on the following regions: South Asia, Europe & Central Asia, Latin America & Caribbean, Middle East & North Africa, East Asia & Pacific, Sub-Saharan Africa, and North America. The objective is to visualize the differences in women's enrollment at different education levels across the world at a global scale and identify any trends or patterns that may arise. This will also allow us to consider if some regions are worth exploring in more detail than others in our analysis.

<figure>
  <div id="container"></div>
  <figcaption>This chart shows the Female Gross Enrollment Ratios by Region for the year 2014. These region delimitations have been chosen from what the World Bank utilize for their studies. You can select and deselect regions to focus on different regions, each bubble inside the region represents an education level, and the values inside are the female gross enrollment ration for 2014. The sizes of the bubbles correlate to the values. Note that because of the way data is collected, small discrepancies in the reported age of children may occasionally cause net enrollment rates to exceed 100 percent by the World Bank. </figcaption>
</figure>

<script>
// Define initial dataset
initialData = [
  {
    "Country Name": "East Asia & Pacific",
    "Indicator": "primary",
    "Value": 104.9668
  },
  {
    "Country Name": "East Asia & Pacific",
    "Indicator": "secondary",
    "Value": 88.3206
  },
  {
    "Country Name": "East Asia & Pacific",
    "Indicator": "tertiary",
    "Value": 41.4262
  },
  {
    "Country Name": "Europe & Central Asia",
    "Indicator": "primary",
    "Value": 103.1583
  },
  {
    "Country Name": "Europe & Central Asia",
    "Indicator": "secondary",
    "Value": 105.389
  },
  {
    "Country Name": "Europe & Central Asia",
    "Indicator": "tertiary",
    "Value": 69.8713
  },
  {
    "Country Name": "Latin America & Caribbean",
    "Indicator": "primary",
    "Value": 107.0963
  },
  {
    "Country Name": "Latin America & Caribbean",
    "Indicator": "secondary",
    "Value": 97.2036
  },
  {
    "Country Name": "Latin America & Caribbean",
    "Indicator": "tertiary",
    "Value": 50.4229
  },
  {
    "Country Name": "Middle East & North Africa",
    "Indicator": "primary",
    "Value": 103.047
  },
  {
    "Country Name": "Middle East & North Africa",
    "Indicator": "secondary",
    "Value": 76.9069
  },
  {
    "Country Name": "Middle East & North Africa",
    "Indicator": "tertiary",
    "Value": 38.2514
  },
  {
    "Country Name": "North America",
    "Indicator": "primary",
    "Value": 99.3733
  },
  {
    "Country Name": "North America",
    "Indicator": "secondary",
    "Value": 99.5089
  },
  {
    "Country Name": "North America",
    "Indicator": "tertiary",
    "Value": 97.5233
  },
  {
    "Country Name": "South Asia",
    "Indicator": "primary",
    "Value": 112.5074
  },
  {
    "Country Name": "South Asia",
    "Indicator": "secondary",
    "Value": 64.4181
  },
  {
    "Country Name": "South Asia",
    "Indicator": "tertiary",
    "Value": 19.9473
  },
  {
    "Country Name": "Sub-Saharan Africa",
    "Indicator": "primary",
    "Value": 94.7694
  },
  {
    "Country Name": "Sub-Saharan Africa",
    "Indicator": "secondary",
    "Value": 39.5397
  },
  {
    "Country Name": "Sub-Saharan Africa",
    "Indicator": "tertiary",
    "Value": 7.2428
  }
]
;

// Filter and parse the dataset to remove "NA" values and convert "Value" to float
parsedData = initialData.filter(d => d.Value !== "NA").map(d => ({
  ...d,
  Value: parseFloat(d.Value)
}));

// Reduce the data to group it by "Country Name" and accumulate the indicators and values
seriesData = parsedData.reduce((acc, { "Country Name": countryName, Indicator, Value }) => {
  let group = acc.find(g => g.name === countryName);
  if (!group) {
    group = { name: countryName, data: [] };
    acc.push(group);
  }
  group.data.push({ name: Indicator, value: Value });
  return acc;
}, []);

// bubble colors
hex_colors = [
    "#a08a68", "#ffa205", "#ff4500", "#08030a", "#5f0922", "#3d6469", "#d40637"
]
// plot
function renderChart() {
    Highcharts.chart('container', {
        chart: {
            type: 'packedbubble',
            height: '100%'
        },
        title: {
            text: 'Female Gross Enrollment Ratios by Region (2014)'
        },
        tooltip: {
            useHTML: true,
            pointFormat: '<b>{point.name}:</b> {point.value}%'
        },
        plotOptions: {
            packedbubble: {
                minSize: '5%',
                maxSize: '100%',
                zMin: 0,
                zMax: 400,
                layoutAlgorithm: {
                    gravitationalConstant: 0.05,
                    splitSeries: true,
                    seriesInteraction: false,
                    dragBetweenSeries: true,
                    parentNodeLimit: true
                },
                dataLabels: {
                    enabled: true,
                    format: '{point.name}',
                    style: {
                        color: 'black',
                        textOutline: 'none',
                        fontWeight: 'normal'
                    }
                }
            }
        },
        series: seriesData.map((series, index) => ({
           ...series,
            color: hex_colors[index % hex_colors.length]
        }))
    });
};
// call function
renderChart();
</script>

From the chart above, not surprisingly, we can see that for all regions, the higher the education level, the lower the enrollment ratio. This is expected as the higher the education level, the more specialized and less accessible it becomes. However, we can see that there are some regions that have higher enrollment ratios than others. Specifically, the regions with the lowest enrollment, specifically South Asia and Sub-Saharan Africa, followed by Mid due East & North Africa, Latin America & Caribbean, and East Asia & Pacific. However, the scope of regions limits our ability to make a thoughtful comparison, as we do not know if data has not been collected by the World Bank in some countries. 

This is important information to consider as we move forward with our analysis. One can think that it may be due to economic reasons, social and ideological reasons, or even political reasons. However, this problem has been present for decades and instead of taking assumptions to answer this question, we should identify the key reasons for this disparity and address it accordingly.


# Let's Start with the World 
Having a sense of the global picture is important to understand the context of the data. We will start by looking at the Gross Enrollment Ratio per level in the world. this will allow us not only to identify different areas where there are discrepancies or the gender gap in education is more pronounced, but also what data was available to the World Bank. Furthermore, we can also contrast globally different levels of education.

```{r, message=FALSE, warning=FALSE, eval=FALSE}
# Load necessary libraries
library(dplyr)
library(jsonlite)

# Read data from CSV
data <- read.csv("cleaned_data/filtered_education_data.csv")

# indicators to keep
indicators <- c("Gross enrolment ratio, primary, female (%)",
                "Gross enrolment ratio, secondary, female (%)",
                "Gross enrolment ratio, tertiary, female (%)")

# Function to save data to JSON
save_json_by_indicator <- function(indicator_name) {
  filtered_data <- data %>%
    filter(Indicator.Name == indicator_name, !is.na(X2014)) %>%
    mutate(name = Country.Code, value = X2014) %>%
    select(name, value) %>%
    filter(!name %in% c("Arab World", "East Asia & Pacific", "East Asia & Pacific (excluding high income)", "Euro area", "Europe & Central Asia", "Europe & Central Asia (excluding high income)", "European Union", "Heavily indebted poor countries (HIPC)", "High income", "Latin America & Caribbean", "Latin America & Caribbean (excluding high income)", "Low & middle income", "Low income", "Lower middle income", "Middle East & North Africa", "Middle East & North Africa (excluding high income)", "Middle income", "North America", "OECD members", "South Asia", "Sub-Saharan Africa", "Sub-Saharan Africa (excluding high income)", "Upper middle income", "World", "Least developed countries: UN classification"))

  if (nrow(filtered_data) > 0) {
    json_data <- toJSON(filtered_data, pretty = TRUE)
    file_name <- paste0("map/data/", gsub("[, %]", "", gsub(" ", "_", indicator_name)), ".json")
    write(json_data, file = file_name)
    return(paste("Data written to", file_name, "with", nrow(filtered_data), "records"))
  } else {
    return(paste("No data found for", indicator_name))
  }
}
# Save data to JSON
results <- lapply(indicators, save_json_by_indicator)
```

::: {.panel-tabset}

## Primary Ed.

<figure>
  <div id="primary-container" style="width: 100%; height: 500px;"></div>
  <figcaption>These plots show the Gross Enrollment Ratio per education level around the world. Only the values collected by the World Bank are being displayed. Countries that did not share information do not display any values. Note that because of the way data is collected,  small discrepancies in the reported age of children may occasionally cause net enrollment rates to exceed 100 percent by the World Bank. However, this allows us to visualize high vs low enrollment and contrast regions of interest.</figcaption>
</figure>

<script>
// Define colors
colorPalette = [
  [0, '#4a0018'],    // very dark red
  [0.1, '#5a2035'],  // dark red-maroon
  [0.2, '#6a4060'],  // dark red-purple
  [0.3, '#7a6078'],  // red-purple
  [0.4, '#8a8090'],  // cool purple
  [0.5, '#9a9fb0'],  // muted blue-purple
  [0.6, '#aac0c0'],  // muted blue
  [0.7, '#a6d0cc'],  // light blue-green
  [0.8, '#a2dfd8'],  // lighter blue-green
  [0.9, '#9eefde'],  // very light blue-green
  [1, '#9afae4']     // pale blue-green
];

// define data
data1 = [
  {
    "name": "ARB",
    "value": 93.608
  },
  {
    "name": "EAS",
    "value": 104.9668
  },
  {
    "name": "EAP",
    "value": 105.2243
  },
  {
    "name": "EMU",
    "value": 103.4798
  },
  {
    "name": "ECS",
    "value": 103.1583
  },
  {
    "name": "ECA",
    "value": 101.6871
  },
  {
    "name": "EUU",
    "value": 103.9449
  },
  {
    "name": "HPC",
    "value": 98.0805
  },
  {
    "name": "HIC",
    "value": 102.0787
  },
  {
    "name": "LCN",
    "value": 107.0963
  },
  {
    "name": "LAC",
    "value": 107.3809
  },
  {
    "name": "LDC",
    "value": 100.2302
  },
  {
    "name": "LMY",
    "value": 104.3708
  },
  {
    "name": "LIC",
    "value": 99.2115
  },
  {
    "name": "LMC",
    "value": 105.5588
  },
  {
    "name": "MEA",
    "value": 103.047
  },
  {
    "name": "MNA",
    "value": 102.4904
  },
  {
    "name": "MIC",
    "value": 105.0638
  },
  {
    "name": "NAC",
    "value": 99.3733
  },
  {
    "name": "OED",
    "value": 102.2592
  },
  {
    "name": "SAS",
    "value": 112.5074
  },
  {
    "name": "SSF",
    "value": 94.7694
  },
  {
    "name": "SSA",
    "value": 94.7689
  },
  {
    "name": "UMC",
    "value": 104.2601
  },
  {
    "name": "WLD",
    "value": 103.8494
  },
  {
    "name": "AFG",
    "value": 91.7579
  },
  {
    "name": "ALB",
    "value": 111.1673
  },
  {
    "name": "DZA",
    "value": 115.1333
  },
  {
    "name": "ATG",
    "value": 93.3092
  },
  {
    "name": "ARG",
    "value": 109.7614
  },
  {
    "name": "ABW",
    "value": 115.4297
  },
  {
    "name": "AUS",
    "value": 105.7587
  },
  {
    "name": "AUT",
    "value": 101.6984
  },
  {
    "name": "AZE",
    "value": 105.493
  },
  {
    "name": "BHR",
    "value": 100.456
  },
  {
    "name": "BRB",
    "value": 94.1669
  },
  {
    "name": "BLR",
    "value": 99.0571
  },
  {
    "name": "BEL",
    "value": 104.9222
  },
  {
    "name": "BLZ",
    "value": 108.95
  },
  {
    "name": "BEN",
    "value": 119.9226
  },
  {
    "name": "BMU",
    "value": 86.0617
  },
  {
    "name": "BTN",
    "value": 102.8738
  },
  {
    "name": "BOL",
    "value": 95.8438
  },
  {
    "name": "BWA",
    "value": 105.8012
  },
  {
    "name": "BRA",
    "value": 108.9931
  },
  {
    "name": "BRN",
    "value": 107.5561
  },
  {
    "name": "BGR",
    "value": 98.7499
  },
  {
    "name": "BFA",
    "value": 85.0913
  },
  {
    "name": "BDI",
    "value": 128.4259
  },
  {
    "name": "CPV",
    "value": 109.907
  },
  {
    "name": "KHM",
    "value": 113.1353
  },
  {
    "name": "CMR",
    "value": 106.885
  },
  {
    "name": "CHL",
    "value": 98.8515
  },
  {
    "name": "CHN",
    "value": 104.0123
  },
  {
    "name": "COL",
    "value": 111.7424
  },
  {
    "name": "COM",
    "value": 99.4594
  },
  {
    "name": "COD",
    "value": 101.8445
  },
  {
    "name": "CRI",
    "value": 110.286
  },
  {
    "name": "CIV",
    "value": 83.5878
  },
  {
    "name": "HRV",
    "value": 98.7139
  },
  {
    "name": "CUB",
    "value": 95.8327
  },
  {
    "name": "CYP",
    "value": 99.5871
  },
  {
    "name": "CZE",
    "value": 98.8783
  },
  {
    "name": "DNK",
    "value": 100.6596
  },
  {
    "name": "DJI",
    "value": 63.263
  },
  {
    "name": "DMA",
    "value": 117.9919
  },
  {
    "name": "DOM",
    "value": 95.7246
  },
  {
    "name": "ECU",
    "value": 113.4911
  },
  {
    "name": "EGY",
    "value": 103.7742
  },
  {
    "name": "SLV",
    "value": 109.7239
  },
  {
    "name": "ERI",
    "value": 47.1461
  },
  {
    "name": "EST",
    "value": 99.0226
  },
  {
    "name": "ETH",
    "value": 95.8226
  },
  {
    "name": "FIN",
    "value": 101.3999
  },
  {
    "name": "FRA",
    "value": 104.971
  },
  {
    "name": "GMB",
    "value": 90.8281
  },
  {
    "name": "GEO",
    "value": 117.5432
  },
  {
    "name": "DEU",
    "value": 102.9817
  },
  {
    "name": "GHA",
    "value": 106.4023
  },
  {
    "name": "GRC",
    "value": 97.1059
  },
  {
    "name": "GRD",
    "value": 102.2528
  },
  {
    "name": "GTM",
    "value": 101.5921
  },
  {
    "name": "GIN",
    "value": 83.7966
  },
  {
    "name": "HND",
    "value": 108.0323
  },
  {
    "name": "HUN",
    "value": 100.9149
  },
  {
    "name": "IND",
    "value": 114.0863
  },
  {
    "name": "IDN",
    "value": 104.4599
  },
  {
    "name": "IRN",
    "value": 111.5957
  },
  {
    "name": "IRL",
    "value": 102.5718
  },
  {
    "name": "ISR",
    "value": 104.3748
  },
  {
    "name": "ITA",
    "value": 101.0766
  },
  {
    "name": "JPN",
    "value": 101.1876
  },
  {
    "name": "JOR",
    "value": 97.6112
  },
  {
    "name": "KAZ",
    "value": 111.3404
  },
  {
    "name": "KEN",
    "value": 111.5768
  },
  {
    "name": "KIR",
    "value": 115.182
  },
  {
    "name": "KOR",
    "value": 98.5283
  },
  {
    "name": "KWT",
    "value": 103.025
  },
  {
    "name": "KGZ",
    "value": 107.0264
  },
  {
    "name": "LAO",
    "value": 113.4927
  },
  {
    "name": "LVA",
    "value": 99.9731
  },
  {
    "name": "LBN",
    "value": 89.9923
  },
  {
    "name": "LSO",
    "value": 105.8455
  },
  {
    "name": "LBR",
    "value": 91.59
  },
  {
    "name": "LIE",
    "value": 102.2556
  },
  {
    "name": "LTU",
    "value": 102.6071
  },
  {
    "name": "LUX",
    "value": 97.3323
  },
  {
    "name": "MAC",
    "value": 96.3242
  },
  {
    "name": "MKD",
    "value": 89.6473
  },
  {
    "name": "MDG",
    "value": 146.542
  },
  {
    "name": "MWI",
    "value": 147.9642
  },
  {
    "name": "MYS",
    "value": 102.905
  },
  {
    "name": "MLI",
    "value": 72.977
  },
  {
    "name": "MLT",
    "value": 102.7591
  },
  {
    "name": "MRT",
    "value": 100.6721
  },
  {
    "name": "MUS",
    "value": 103.7294
  },
  {
    "name": "MEX",
    "value": 103.1544
  },
  {
    "name": "FSM",
    "value": 97.1805
  },
  {
    "name": "MDA",
    "value": 92.8593
  },
  {
    "name": "MNG",
    "value": 100.6383
  },
  {
    "name": "MAR",
    "value": 113.3955
  },
  {
    "name": "MOZ",
    "value": 100.2787
  },
  {
    "name": "MMR",
    "value": 98.2936
  },
  {
    "name": "NRU",
    "value": 100.4011
  },
  {
    "name": "NPL",
    "value": 140.6295
  },
  {
    "name": "NLD",
    "value": 104.095
  },
  {
    "name": "NZL",
    "value": 98.4593
  },
  {
    "name": "NER",
    "value": 65.0248
  },
  {
    "name": "NOR",
    "value": 100.1206
  },
  {
    "name": "OMN",
    "value": 114.0607
  },
  {
    "name": "PAK",
    "value": 85.8102
  },
  {
    "name": "PLW",
    "value": 111.791
  },
  {
    "name": "PAN",
    "value": 100.8738
  },
  {
    "name": "PER",
    "value": 101.4283
  },
  {
    "name": "POL",
    "value": 100.6509
  },
  {
    "name": "PRT",
    "value": 106.1384
  },
  {
    "name": "PRI",
    "value": 90.4305
  },
  {
    "name": "QAT",
    "value": 100.7764
  },
  {
    "name": "RUS",
    "value": 98.9205
  },
  {
    "name": "RWA",
    "value": 135.1156
  },
  {
    "name": "WSM",
    "value": 106.2645
  },
  {
    "name": "STP",
    "value": 109.4119
  },
  {
    "name": "SAU",
    "value": 108.2517
  },
  {
    "name": "SEN",
    "value": 84.3095
  },
  {
    "name": "SRB",
    "value": 101.3633
  },
  {
    "name": "SYC",
    "value": 104.7033
  },
  {
    "name": "SVK",
    "value": 100.3733
  },
  {
    "name": "SVN",
    "value": 99.3749
  },
  {
    "name": "SLB",
    "value": 112.103
  },
  {
    "name": "ZAF",
    "value": 97.2689
  },
  {
    "name": "ESP",
    "value": 105.2732
  },
  {
    "name": "LKA",
    "value": 100.1062
  },
  {
    "name": "KNA",
    "value": 84.4902
  },
  {
    "name": "VCT",
    "value": 103.0432
  },
  {
    "name": "SUR",
    "value": 118.2731
  },
  {
    "name": "SWZ",
    "value": 107.951
  },
  {
    "name": "SWE",
    "value": 124.2636
  },
  {
    "name": "CHE",
    "value": 103.2725
  },
  {
    "name": "TJK",
    "value": 97.1398
  },
  {
    "name": "TZA",
    "value": 84.6786
  },
  {
    "name": "THA",
    "value": 104.0782
  },
  {
    "name": "TLS",
    "value": 136.047
  },
  {
    "name": "TGO",
    "value": 121.4028
  },
  {
    "name": "TON",
    "value": 107.465
  },
  {
    "name": "TUN",
    "value": 111.3951
  },
  {
    "name": "TUR",
    "value": 105.6009
  },
  {
    "name": "TKM",
    "value": 88.6385
  },
  {
    "name": "TUV",
    "value": 102.1212
  },
  {
    "name": "UKR",
    "value": 105.0629
  },
  {
    "name": "ARE",
    "value": 107.1077
  },
  {
    "name": "GBR",
    "value": 108.0794
  },
  {
    "name": "USA",
    "value": 99.2292
  },
  {
    "name": "URY",
    "value": 107.2961
  },
  {
    "name": "UZB",
    "value": 98.9494
  },
  {
    "name": "VEN",
    "value": 99.6989
  },
  {
    "name": "VNM",
    "value": 108.6183
  },
  {
    "name": "PSE",
    "value": 94.567
  }
];
// load topology and render map
async function renderMapChart(data, colorPalette) {
    let topology = await fetch('https://code.highcharts.com/mapdata/custom/world.topo.json')
        .then(response => response.json());

    Highcharts.mapChart('primary-container', {
        chart: {
            map: topology
        },
        title: {
            text: 'Gross Enrolment Ratio in 2014 - Primary Education (Female)',
            align: 'left'
        },
        credits: {
            href: '',
            text: ''
        },
        mapNavigation: {
            enabled: true,
            buttonOptions: {
                verticalAlign: 'bottom'
            }
        },
        colorAxis: {
            min: 0,
            max: 101,
            type: 'linear',
            stops: colorPalette
        },
        series: [{
            name: 'Gross Enrolment Ratio',
            joinBy: ['iso-a3', 'name'],
            data: data,
            dataLabels: {
                enabled: true,
                format: '{point.value:.1f}',
                style: {
                    fontWeight: 'normal'
                }
            }
        }]
    });
}

renderMapChart(data1, colorPalette);
</script>

## Secondary Ed.

<figure>
  <div id="secondary-container" style="width: 100%; height: 500px;"></div>
  <figcaption>These plots show the Gross Enrollment Ratio per education level around the world. Only the values collected by the World Bank are being displayed. Countries that did not share information do not display any values. Note that because of the way data is collected,  small discrepancies in the reported age of children may occasionally cause net enrollment rates to exceed 100 percent by the World Bank. However, this allows us to visualize high vs low enrollment and contrast regions of interest.</figcaption>
</figure>

<script>
// define data and load topology
(async () => {
    let topology = await fetch('https://code.highcharts.com/mapdata/custom/world.topo.json')
       .then(response => response.json());

// data
    let data2 = [
  {
    "name": "ARB",
    "value": 67.9689
  },
  {
    "name": "EAS",
    "value": 88.3206
  },
  {
    "name": "EAP",
    "value": 86.9022
  },
  {
    "name": "EMU",
    "value": 110.7075
  },
  {
    "name": "ECS",
    "value": 105.389
  },
  {
    "name": "ECA",
    "value": 97.3475
  },
  {
    "name": "EUU",
    "value": 112.6944
  },
  {
    "name": "HPC",
    "value": 35.621
  },
  {
    "name": "HIC",
    "value": 106.1772
  },
  {
    "name": "LCN",
    "value": 97.2036
  },
  {
    "name": "LAC",
    "value": 97.1722
  },
  {
    "name": "LDC",
    "value": 40.0149
  },
  {
    "name": "LMY",
    "value": 70.4674
  },
  {
    "name": "LIC",
    "value": 35.3647
  },
  {
    "name": "LMC",
    "value": 67.3353
  },
  {
    "name": "MEA",
    "value": 76.9069
  },
  {
    "name": "MNA",
    "value": 74.3971
  },
  {
    "name": "MIC",
    "value": 77.8225
  },
  {
    "name": "NAC",
    "value": 99.5089
  },
  {
    "name": "OED",
    "value": 104.3177
  },
  {
    "name": "SAS",
    "value": 64.4181
  },
  {
    "name": "SSF",
    "value": 39.5397
  },
  {
    "name": "SSA",
    "value": 39.5373
  },
  {
    "name": "UMC",
    "value": 95.6858
  },
  {
    "name": "WLD",
    "value": 76.0124
  },
  {
    "name": "AFG",
    "value": 39.6748
  },
  {
    "name": "ALB",
    "value": 92.6062
  },
  {
    "name": "ATG",
    "value": 102.8447
  },
  {
    "name": "ARG",
    "value": 110.3069
  },
  {
    "name": "AUS",
    "value": 133.6293
  },
  {
    "name": "AUT",
    "value": 96.9263
  },
  {
    "name": "BHR",
    "value": 99.3264
  },
  {
    "name": "BRB",
    "value": 110.681
  },
  {
    "name": "BLR",
    "value": 106.099
  },
  {
    "name": "BEL",
    "value": 175.3805
  },
  {
    "name": "BLZ",
    "value": 81.706
  },
  {
    "name": "BEN",
    "value": 43.8578
  },
  {
    "name": "BMU",
    "value": 77.4333
  },
  {
    "name": "BTN",
    "value": 87.0563
  },
  {
    "name": "BOL",
    "value": 84.9471
  },
  {
    "name": "BRA",
    "value": 105.7857
  },
  {
    "name": "BRN",
    "value": 99.1009
  },
  {
    "name": "BGR",
    "value": 99.0442
  },
  {
    "name": "BFA",
    "value": 28.2284
  },
  {
    "name": "BDI",
    "value": 34.8233
  },
  {
    "name": "CPV",
    "value": 98.5005
  },
  {
    "name": "CMR",
    "value": 51.8602
  },
  {
    "name": "CHL",
    "value": 101.2064
  },
  {
    "name": "CHN",
    "value": 95.4449
  },
  {
    "name": "COL",
    "value": 102.6041
  },
  {
    "name": "COM",
    "value": 62.3779
  },
  {
    "name": "COD",
    "value": 33.3291
  },
  {
    "name": "CRI",
    "value": 123.6083
  },
  {
    "name": "CIV",
    "value": 33.1844
  },
  {
    "name": "HRV",
    "value": 100.8856
  },
  {
    "name": "CUB",
    "value": 101.4099
  },
  {
    "name": "CYP",
    "value": 99.4557
  },
  {
    "name": "CZE",
    "value": 105.3879
  },
  {
    "name": "DNK",
    "value": 132.1924
  },
  {
    "name": "DJI",
    "value": 41.4593
  },
  {
    "name": "DOM",
    "value": 82.3859
  },
  {
    "name": "ECU",
    "value": 106.5813
  },
  {
    "name": "EGY",
    "value": 85.8612
  },
  {
    "name": "SLV",
    "value": 81.3212
  },
  {
    "name": "ERI",
    "value": 31.256
  },
  {
    "name": "EST",
    "value": 110.0609
  },
  {
    "name": "FIN",
    "value": 152.1228
  },
  {
    "name": "FRA",
    "value": 111.2346
  },
  {
    "name": "GEO",
    "value": 99.6031
  },
  {
    "name": "DEU",
    "value": 99.5183
  },
  {
    "name": "GHA",
    "value": 56.0564
  },
  {
    "name": "GRC",
    "value": 103.3957
  },
  {
    "name": "GRD",
    "value": 100.5079
  },
  {
    "name": "GTM",
    "value": 61.5023
  },
  {
    "name": "GIN",
    "value": 30.6916
  },
  {
    "name": "HND",
    "value": 73.7329
  },
  {
    "name": "HKG",
    "value": 98.6149
  },
  {
    "name": "HUN",
    "value": 107.1067
  },
  {
    "name": "IND",
    "value": 74.7918
  },
  {
    "name": "IDN",
    "value": 82.1618
  },
  {
    "name": "IRN",
    "value": 87.9024
  },
  {
    "name": "IRL",
    "value": 128.6722
  },
  {
    "name": "ISR",
    "value": 102.6643
  },
  {
    "name": "ITA",
    "value": 101.4576
  },
  {
    "name": "JAM",
    "value": 86.3304
  },
  {
    "name": "JPN",
    "value": 101.9092
  },
  {
    "name": "JOR",
    "value": 84.8077
  },
  {
    "name": "KAZ",
    "value": 106.8409
  },
  {
    "name": "KOR",
    "value": 97.9589
  },
  {
    "name": "KWT",
    "value": 98.9087
  },
  {
    "name": "KGZ",
    "value": 91.1788
  },
  {
    "name": "LAO",
    "value": 54.5729
  },
  {
    "name": "LVA",
    "value": 114.0094
  },
  {
    "name": "LBN",
    "value": 61.8202
  },
  {
    "name": "LSO",
    "value": 60.4161
  },
  {
    "name": "LBR",
    "value": 33.1167
  },
  {
    "name": "LIE",
    "value": 103.2742
  },
  {
    "name": "LTU",
    "value": 104.617
  },
  {
    "name": "LUX",
    "value": 103.4755
  },
  {
    "name": "MAC",
    "value": 95.0437
  },
  {
    "name": "MKD",
    "value": 77.0836
  },
  {
    "name": "MDG",
    "value": 38.0608
  },
  {
    "name": "MWI",
    "value": 37.5407
  },
  {
    "name": "MYS",
    "value": 80.6655
  },
  {
    "name": "MLI",
    "value": 37.3652
  },
  {
    "name": "MLT",
    "value": 96.4711
  },
  {
    "name": "MRT",
    "value": 28.5849
  },
  {
    "name": "MUS",
    "value": 98.9862
  },
  {
    "name": "MEX",
    "value": 93.4649
  },
  {
    "name": "MDA",
    "value": 87.8893
  },
  {
    "name": "MOZ",
    "value": 30.5309
  },
  {
    "name": "MMR",
    "value": 51.9519
  },
  {
    "name": "NRU",
    "value": 83.4437
  },
  {
    "name": "NPL",
    "value": 68.8987
  },
  {
    "name": "NZL",
    "value": 120.9874
  },
  {
    "name": "NER",
    "value": 15.5587
  },
  {
    "name": "NOR",
    "value": 110.6189
  },
  {
    "name": "PAK",
    "value": 36.606
  },
  {
    "name": "PLW",
    "value": 116.9367
  },
  {
    "name": "PAN",
    "value": 78.3069
  },
  {
    "name": "PER",
    "value": 95.502
  },
  {
    "name": "POL",
    "value": 106.0829
  },
  {
    "name": "PRT",
    "value": 114.9665
  },
  {
    "name": "PRI",
    "value": 83.9338
  },
  {
    "name": "QAT",
    "value": 100.5274
  },
  {
    "name": "ROU",
    "value": 94.2833
  },
  {
    "name": "RUS",
    "value": 99.5336
  },
  {
    "name": "RWA",
    "value": 40.8854
  },
  {
    "name": "WSM",
    "value": 92.1822
  },
  {
    "name": "STP",
    "value": 80.4445
  },
  {
    "name": "SAU",
    "value": 93.7468
  },
  {
    "name": "SRB",
    "value": 95.4097
  },
  {
    "name": "SYC",
    "value": 81.1022
  },
  {
    "name": "SVK",
    "value": 92.3471
  },
  {
    "name": "SVN",
    "value": 110.5333
  },
  {
    "name": "ZAF",
    "value": 111.5194
  },
  {
    "name": "ESP",
    "value": 130.4096
  },
  {
    "name": "KNA",
    "value": 92.7512
  },
  {
    "name": "LCA",
    "value": 86.2007
  },
  {
    "name": "VCT",
    "value": 103.1762
  },
  {
    "name": "SUR",
    "value": 88.6371
  },
  {
    "name": "SWZ",
    "value": 65.8041
  },
  {
    "name": "SWE",
    "value": 141.5963
  },
  {
    "name": "CHE",
    "value": 98.2076
  },
  {
    "name": "THA",
    "value": 130.0553
  },
  {
    "name": "TLS",
    "value": 75.973
  },
  {
    "name": "TON",
    "value": 94.221
  },
  {
    "name": "TUR",
    "value": 101.1408
  },
  {
    "name": "TKM",
    "value": 83.7067
  },
  {
    "name": "TUV",
    "value": 90.2128
  },
  {
    "name": "UKR",
    "value": 98.2202
  },
  {
    "name": "GBR",
    "value": 130.4024
  },
  {
    "name": "USA",
    "value": 98.4728
  },
  {
    "name": "URY",
    "value": 99.996
  },
  {
    "name": "UZB",
    "value": 95.5688
  },
  {
    "name": "VEN",
    "value": 95.0397
  },
  {
    "name": "PSE",
    "value": 86.1715
  }
];

 // Map chart
Highcharts.mapChart(document.getElementById('secondary-container'), {
chart: {
map: topology
},
title: {
text: 'Gross Enrolment Ratio in 2014 - Secondary Education (Female)',
align: 'left'
},
credits: {
href: '',
text: ''
},
mapNavigation: {
enabled: true,
buttonOptions: {
verticalAlign: 'bottom'
}
},
colorAxis: {
    min: 0,
    max: 101,
    type: 'linear',
    stops: colorPalette
  },
series: [{
  name: 'Gross Enrolment Ratio',
  joinBy: ['iso-a3', 'name'],
  data: data2,
  dataLabels: {
    enabled: true,
    format: '{point.value:.1f}',
    style: {
      fontWeight: 'normal'
    }
  }
}]
});
})();
</script>

## Tertiary Ed.

<figure>
  <div id="tertiary-container" style="width: 100%; height: 500px;"></div>
  <figcaption>These plots show the Gross Enrollment Ratio per education level around the world. Only the values collected by the World Bank are being displayed. Countries that did not share information do not display any values. Note that because of the way data is collected,  small discrepancies in the reported age of children may occasionally cause net enrollment rates to exceed 100 percent by the World Bank. However, this allows us to visualize high vs low enrollment and contrast regions of interest.</figcaption>
</figure>

<script>
// define data and load topology
(async () => {
    let topology = await fetch('https://code.highcharts.com/mapdata/custom/world.topo.json')
       .then(response => response.json());
// data
    let data3 = [
  {
    "name": "ARB",
    "value": 28.768
  },
  {
    "name": "EAS",
    "value": 41.4262
  },
  {
    "name": "EAP",
    "value": 39.1341
  },
  {
    "name": "EMU",
    "value": 76.299
  },
  {
    "name": "ECS",
    "value": 69.8713
  },
  {
    "name": "ECA",
    "value": 64.5301
  },
  {
    "name": "EUU",
    "value": 74.8719
  },
  {
    "name": "HPC",
    "value": 6.233
  },
  {
    "name": "HIC",
    "value": 81.3627
  },
  {
    "name": "LCN",
    "value": 50.4229
  },
  {
    "name": "LAC",
    "value": 48.967
  },
  {
    "name": "LDC",
    "value": 7.2776
  },
  {
    "name": "LMY",
    "value": 30.0104
  },
  {
    "name": "LIC",
    "value": 5.3644
  },
  {
    "name": "LMC",
    "value": 23.0272
  },
  {
    "name": "MEA",
    "value": 38.2514
  },
  {
    "name": "MNA",
    "value": 36.1012
  },
  {
    "name": "MIC",
    "value": 34.0113
  },
  {
    "name": "NAC",
    "value": 97.5233
  },
  {
    "name": "OED",
    "value": 75.5335
  },
  {
    "name": "SAS",
    "value": 19.9473
  },
  {
    "name": "SSF",
    "value": 7.2428
  },
  {
    "name": "SSA",
    "value": 7.2426
  },
  {
    "name": "UMC",
    "value": 48.2362
  },
  {
    "name": "WLD",
    "value": 36.904
  },
  {
    "name": "AFG",
    "value": 3.6733
  },
  {
    "name": "ALB",
    "value": 73.827
  },
  {
    "name": "DZA",
    "value": 41.9319
  },
  {
    "name": "ARG",
    "value": 102.8994
  },
  {
    "name": "ARM",
    "value": 48.4957
  },
  {
    "name": "ABW",
    "value": 23.0432
  },
  {
    "name": "AUS",
    "value": 106.3088
  },
  {
    "name": "AUT",
    "value": 87.602
  },
  {
    "name": "AZE",
    "value": 24.7532
  },
  {
    "name": "BHR",
    "value": 57.6057
  },
  {
    "name": "BGD",
    "value": 11.3874
  },
  {
    "name": "BLR",
    "value": 101.9697
  },
  {
    "name": "BEL",
    "value": 83.3614
  },
  {
    "name": "BMU",
    "value": 36.0804
  },
  {
    "name": "BWA",
    "value": 27.8302
  },
  {
    "name": "BRA",
    "value": 56.7165
  },
  {
    "name": "BRN",
    "value": 40.1249
  },
  {
    "name": "BGR",
    "value": 78.9854
  },
  {
    "name": "BDI",
    "value": 2.4079
  },
  {
    "name": "CPV",
    "value": 26.752
  },
  {
    "name": "CMR",
    "value": 14.0186
  },
  {
    "name": "TCD",
    "value": 1.133
  },
  {
    "name": "CHL",
    "value": 92.2786
  },
  {
    "name": "CHN",
    "value": 42.5336
  },
  {
    "name": "COL",
    "value": 57.1454
  },
  {
    "name": "COM",
    "value": 7.9895
  },
  {
    "name": "CRI",
    "value": 58.7833
  },
  {
    "name": "CIV",
    "value": 6.3929
  },
  {
    "name": "HRV",
    "value": 80.7207
  },
  {
    "name": "CYP",
    "value": 62.5988
  },
  {
    "name": "CZE",
    "value": 77.3893
  },
  {
    "name": "DNK",
    "value": 95.3878
  },
  {
    "name": "DOM",
    "value": 58.839
  },
  {
    "name": "EGY",
    "value": 29.9151
  },
  {
    "name": "SLV",
    "value": 30.1207
  },
  {
    "name": "ERI",
    "value": 1.6987
  },
  {
    "name": "EST",
    "value": 86.7456
  },
  {
    "name": "ETH",
    "value": 5.2668
  },
  {
    "name": "FIN",
    "value": 97.1937
  },
  {
    "name": "FRA",
    "value": 71.0006
  },
  {
    "name": "GEO",
    "value": 43.6902
  },
  {
    "name": "DEU",
    "value": 63.2546
  },
  {
    "name": "GHA",
    "value": 12.6413
  },
  {
    "name": "GRC",
    "value": 113.7101
  },
  {
    "name": "GIN",
    "value": 6.68
  },
  {
    "name": "HND",
    "value": 24.3899
  },
  {
    "name": "HKG",
    "value": 73.7638
  },
  {
    "name": "HUN",
    "value": 60.0327
  },
  {
    "name": "IND",
    "value": 25.3059
  },
  {
    "name": "IDN",
    "value": 32.8157
  },
  {
    "name": "IRN",
    "value": 63.6432
  },
  {
    "name": "IRL",
    "value": 80.3093
  },
  {
    "name": "ISR",
    "value": 76.1696
  },
  {
    "name": "ITA",
    "value": 73.4761
  },
  {
    "name": "JPN",
    "value": 60.8813
  },
  {
    "name": "KAZ",
    "value": 54.169
  },
  {
    "name": "KOR",
    "value": 80.6135
  },
  {
    "name": "KGZ",
    "value": 52.08
  },
  {
    "name": "LAO",
    "value": 16.6891
  },
  {
    "name": "LVA",
    "value": 79.2217
  },
  {
    "name": "LBN",
    "value": 45.7461
  },
  {
    "name": "LSO",
    "value": 11.6922
  },
  {
    "name": "LIE",
    "value": 24.1411
  },
  {
    "name": "LTU",
    "value": 82.0082
  },
  {
    "name": "MAC",
    "value": 78.6494
  },
  {
    "name": "MKD",
    "value": 44.2541
  },
  {
    "name": "MDG",
    "value": 4.5715
  },
  {
    "name": "MYS",
    "value": 33.1642
  },
  {
    "name": "MDV",
    "value": 20.2525
  },
  {
    "name": "MLT",
    "value": 50.8826
  },
  {
    "name": "MUS",
    "value": 42.6936
  },
  {
    "name": "MEX",
    "value": 30.0302
  },
  {
    "name": "MDA",
    "value": 47.2774
  },
  {
    "name": "MNG",
    "value": 75.916
  },
  {
    "name": "MAR",
    "value": 24.681
  },
  {
    "name": "MOZ",
    "value": 4.9736
  },
  {
    "name": "NZL",
    "value": 94.0069
  },
  {
    "name": "NOR",
    "value": 91.3718
  },
  {
    "name": "PAK",
    "value": 10.6705
  },
  {
    "name": "PHL",
    "value": 40.2738
  },
  {
    "name": "POL",
    "value": 82.5519
  },
  {
    "name": "PRT",
    "value": 70.3753
  },
  {
    "name": "PRI",
    "value": 98.8313
  },
  {
    "name": "QAT",
    "value": 39.2326
  },
  {
    "name": "ROU",
    "value": 59.061
  },
  {
    "name": "RUS",
    "value": 86.1742
  },
  {
    "name": "RWA",
    "value": 6.8717
  },
  {
    "name": "STP",
    "value": 9.0473
  },
  {
    "name": "SAU",
    "value": 59.8529
  },
  {
    "name": "SEN",
    "value": 7.7223
  },
  {
    "name": "SRB",
    "value": 66.011
  },
  {
    "name": "SYC",
    "value": 9.3471
  },
  {
    "name": "SVK",
    "value": 64.5809
  },
  {
    "name": "SVN",
    "value": 98.4889
  },
  {
    "name": "ZAF",
    "value": 23.3078
  },
  {
    "name": "ESP",
    "value": 96.9299
  },
  {
    "name": "LKA",
    "value": 21.6925
  },
  {
    "name": "KNA",
    "value": 79.7278
  },
  {
    "name": "LCA",
    "value": 22.8565
  },
  {
    "name": "SDN",
    "value": 16.8261
  },
  {
    "name": "SWE",
    "value": 75.96
  },
  {
    "name": "CHE",
    "value": 57.7078
  },
  {
    "name": "SYR",
    "value": 44.9824
  },
  {
    "name": "TJK",
    "value": 18.4034
  },
  {
    "name": "THA",
    "value": 60.0294
  },
  {
    "name": "TGO",
    "value": 5.9446
  },
  {
    "name": "TUN",
    "value": 43.1046
  },
  {
    "name": "TUR",
    "value": 80.1422
  },
  {
    "name": "TKM",
    "value": 6.1999
  },
  {
    "name": "UGA",
    "value": 4.1609
  },
  {
    "name": "UKR",
    "value": 88.4045
  },
  {
    "name": "GBR",
    "value": 64.1236
  },
  {
    "name": "USA",
    "value": 100.702
  },
  {
    "name": "UZB",
    "value": 6.4973
  },
  {
    "name": "VNM",
    "value": 31.2313
  },
  {
    "name": "PSE",
    "value": 53.7615
  }
];

 // Map chart
Highcharts.mapChart(document.getElementById('tertiary-container'), {
chart: {
map: topology
},
title: {
text: 'Gross Enrolment Ratio in 2014 - Tertiary Education (Female)',
align: 'left'
},
credits: {
href: '',
text: ''
},
mapNavigation: {
enabled: true,
buttonOptions: {
verticalAlign: 'bottom'
}
},
colorAxis: {
    min: 0,
    max: 101,
    type: 'linear',
    stops: colorPalette
  },
series: [{
  name: 'Gross Enrolment Ratio',
  joinBy: ['iso-a3', 'name'],
  data: data3,
  dataLabels: {
    enabled: true,
    format: '{point.value:.1f}',
    style: {
      fontWeight: 'normal'
    }
  }
}]
});
})();
</script>

:::

Clearly, from this plots, we can see that globally, thew greater education level, the lower the enrollment rate. This is expected as the higher the education level, the more specialized and innaccessible the education becomes and the less people are likely to enroll in it. However, there seems to be a great disparity in certain areas of the world. For the secundary level, while there is not too much data available in this region, Sub-Saharan Africa seems to have the lowest enrollment rates with rates as low as 28%. This is concerning as in many countries, secondary education is actually mandatory. For the tertiary level, the same region seems to have extremely low enrollment rates, along with Latin America and the Caribbean, East Asia and the Pacific, and the Middle East and North Africa. However, there are outliers in this countries and they can be identified and studied more in depth in order to identify the reasons behind the high enrollment rates and try to mimic them in other countries. Also, Europe and Central Asia along with North America seem to have the highest enrollment rates in the world, making them a good example to follow.

# Economic Influences on Female Access to Education 

The World Bank assigns the worlds economies to four income groups, low income, lower-middle, upper-middle, and high income. 

| Income Category   | FY 2022           | FY 2023           | FY 2024           |
|-------------------|-------------------|-------------------|-------------------|
| Low Income        |  1,045           |  1,085           |  1,135           |
| Lower-middle      | 1,046 - 4,095     | 1,086 - 4,255     | 1,136 - 4,465     |
| Upper-middle      | 4,096 - 12,695    | 4,256 - 13,205    | 4,466 - 13,845    |
| High Income       |  12,695          |  13,205          |  13,846         |



The classifications are updated each year on July 1 and are based on the GNI per capita of the previous year (2021). GNI measures are expressed in United States dollars (USD), and are determined using conversion factors derived according to the Atlas method (The Atlas method smooths exchange rate fluctuations using a three-year moving average, price-adjusted conversion factor. The USD estimate of GNI per capita is derived by applying the Atlas conversion factor to estimates measured in  local currency units (LCU)).


```{ojs}
import { slider } from "@jashkenas/inputs"
import { vl } from "@vega/vega-lite-api"
```

```{ojs}
function parseCSV(csvString) {
  return d3.csvParse(csvString);
}
```

```{ojs}
// Import the necessary libraries
d3 = require("d3", "d3-svg-legend")

// Define and load your datasets
dat = await FileAttachment('parallel_coordinates_plot/parallel_coordinates_df.csv')
 .text()
 .then(parseCSV)
 .then(data => data.map(d => ({
    'Country': d['Country'], 
    'Region': d['Region'], 
    'Female enrolment ratio': +d['Female enrolment ratio'],
    'GDP per capita (USD)': +d['GDP per capita (USD)'],
    'GNI per capita (USD)': +d['GNI per capita (USD)'],
    'Income group': d['Income group']
  })));


```

```{ojs}
viewof numTicks = slider({
  min: 0,
  max: 1,
  value: 2,
  step: 1,
  title: "Number of vertical ticks"
})
```


```{ojs}
chart_parallel = {
  const height = 350;
  const labelMap = {
    gdp_per_capita: "GDP per Capita",
    gni_per_capita: "GNI per Capita",
    enrolment_ratio_female: "Female Enrolment Ratio",
    income_group: "Income Group",
  };
  
  const hover = vl
    .selectSingle()
    .on("mouseover")
    .nearest(true)
    .empty("none");

  const base = vl.markRule({ color: "#ccc" }).encode(
  vl.x().fieldN("key").sort(['GDP per capita (USD)', 'Female enrolment ratio', 'GNI per capita (USD)']).title(d => labelMap[d] || d),  // Explicitly sort by desired order
  vl.detail().count()
);

const line = base.markLine().encode(
  vl.color().fieldN("Income group").scale({
    domain: ['Low income', 'Lower middle income', 'Upper middle income', 'High income'],  // Adjust these categories based on your actual data
    range: ['#ff4500', '#ffa205', '#d40637', '#5f0922']
  }),
  vl.detail().fieldN("index"),
  vl.opacity().if(hover, vl.value(1)).value(0.3),
  vl.y().fieldQ("norm_val").axis(null),
  vl.tooltip([
    'Country',
    'Region',
    'Female enrolment ratio', 
    'GDP per capita (USD)', 
    'GNI per capita (USD)', 
    'Income group'
  ])
);
  const points = line.markCircle()
    .select(hover)
    .encode(vl.size().if(hover, vl.value(50)).value(5));

  // Generates a spec to show tick values at an specific value of y0
  const tick = y0 =>
    vl.layer(
        base.markText({ style: "label" }).encode(vl.text().max("max")),
        base.markTick({ style: "tick", size: 8, color: "#ccc" })
      )
      .encode(vl.y().value(y0));

  // Create an array with *numTicks* ticks
  const ticks = Array.from({ length: numTicks })
    .map((_, i) => tick((height / (numTicks - 1)) * i));

return vl
    .layer(base, line, points, ...ticks)
    .data(dat)
    .transform(
      vl.filter(attribs.map(a => `datum["${a}"] != null`).join(" && ")),
      vl.window(vl.count().as("index")),
      vl.fold(attribs),
      vl.groupby("key").joinaggregate(vl.min("value").as("min"), vl.max("value").as("max")),
      vl.calculate("(datum.value - datum.min) / (datum.max - datum.min)").as("norm_val"),
      vl.calculate("(datum.min + datum.max) / 2").as("mid")
    )
    .config({
      axisX: { domain: false, labelAngle: 0, tickColor: "#ccc", title: null },
      view: { stroke: null },
      style: {
        label: { baseline: "middle", align: "right", dx: -5 },
        tick: { orient: "horizontal" }
      }
    })
    .width(width - 100)
    .height(height)
    .title({
      text: 'Economic and Educational Indicators by Income Group',
      fontSize: 12,
      fontWeight: 'normal',
      anchor: 'middle',
      color: 'black',
      font: 'monospace',
      offset: 40
    })
    .render();


}
```


```{ojs}
attribs = Object.keys(dat[0]).filter(a => !isNaN(dat[0][a])) //Find the attributes that are numbers
```

## Government Spending (Dollar per person)
```{ojs}
viewof metric = Inputs.radio(new Map([["Absolute", "absolute"], ["Relative", "relative"]]), {value: "absolute", label: "Change"})
```

```{ojs}
viewof selectedDataset = Inputs.select(['Primary', 'Secondary', 'Tertiary'], {label: 'Dataset: ', value: 'Primary'})
```

```{ojs}
chart_gov_exp = async () => {
  // Load primary data
  const primaryData = await FileAttachment("government_expenditure_plot/primary_1.csv").text().then(parseCSV);

  // Load secondary data
  const secondaryData = await FileAttachment("government_expenditure_plot/secondary_1.csv").text().then(parseCSV);

  // Load tertiary data
  const tertiaryData = await FileAttachment("government_expenditure_plot/tertiary_1.csv").text().then(parseCSV);

  const selected = await selectedDataset;

  let data;
  if (selected === 'Primary') {
    data = primaryData;
  } else if (selected === 'Secondary') {
    data = secondaryData;
  } else if (selected === 'Tertiary') {
    data = tertiaryData;
  }
  
  data = data.map(d => ({
    country_name: d.country_name,
    value: metric === 'absolute' ? d.year2 - d.year1 : (d.year2 - d.year1) / d.year1
  }));

  const barHeight = 25;
  const marginTop = 50; 
  const marginRight = 70;
  const marginBottom = 50; 
  const marginLeft = 120;
  const height = Math.ceil((data.length + 0.1) * barHeight) + marginTop + marginBottom;

  const x = d3.scaleLinear()
    .domain(d3.extent(data, d => d.value))
    .rangeRound([marginLeft, width - marginRight]);

  const y = d3.scaleBand()
    .domain(data.map(d => d.country_name))
    .rangeRound([marginTop, height - marginBottom])
    .padding(0.1);

  const format = d3.format(metric === 'absolute' ? '+,d' : '+.1%');
  const tickFormat = metric === 'absolute' ? d3.formatPrefix('+.1', 1e1) : d3.format('+.0%');

  const svg = d3.create('svg')
    .attr('viewBox', [0, 0, width, height])
    .attr('style', 'max-width: 100%; height: auto; font-family: monospace; font-size: 10px;');

  // Chart Title
  svg.append('text')
    .attr('x', width / 2)
    .attr('y', 13)
    .attr('text-anchor', 'middle')
    .style('font-size', '16px')
    .style('font-weight', 'bold')
    .text('Government Spending for Education');

  // X-axis Label
  svg.append('text')
    .attr('x', width / 2)
    .attr('y', height - 15)
    .attr('text-anchor', 'middle')
    .style('font-size', '12px')
    .text('Dollar / Per Person');

  // Y-axis Label
  svg.append('text')
    .attr('transform', `rotate(-90)`)
    .attr('x', -(height / 2))
    .attr('y', marginLeft - 40)
    .attr('text-anchor', 'middle')
    .style('font-size', '12px')
    .text('Country');

  // Remaining SVG drawing code unchanged, add bars, texts, and axes
  svg.append('g')
    .selectAll('rect')
    .data(data)
    .join('rect')
    .attr('fill', d => d.value > 0 ? '#3d6469' : '#d40637')
    .attr('x', d => x(Math.min(d.value, 0)))
    .attr('y', d => y(d.country_name))
    .attr('width', d => Math.abs(x(d.value) - x(0)))
    .attr('height', y.bandwidth());

  svg.append('g')
    .attr('font-family', 'monospace')
    .attr('font-size', 10)
    .selectAll('text')
    .data(data)
    .join('text')
    .attr('text-anchor', d => d.value < 0 ? 'end' : 'start')
    .attr('x', d => x(d.value) + Math.sign(d.value) * 4)
    .attr('y', d => y(d.country_name) + y.bandwidth() / 2)
    .attr('dy', '0.35em')
    .text(d => format(d.value));

  svg.append('g')
    .attr('transform', `translate(0,${marginTop})`)
    .call(d3.axisTop(x).ticks(width / 80).tickFormat(tickFormat))
    .call(g => g.selectAll('.tick line').clone()
      .attr('y2', height - marginTop - marginBottom)
      .attr('stroke-opacity', 0.1))
    .call(g => g.select('.domain').remove());

  svg.append('g')
    .attr('transform', `translate(${x(0)},0)`)
    .call(d3.axisLeft(y).tickSize(0).tickPadding(6))
    .call(g => g.selectAll('.tick text').filter((d, i) => data[i].value < 0)
      .attr('text-anchor', 'start')
      .attr('x', 6));

  return svg.node();
}

chart_gov_exp();
```

# linky ploty

```{python}
import altair as alt
import pandas as pd

# Load data
region_count = pd.read_json("map/data/regions.json")
overtime = pd.read_csv("cleaned_data/filtered_linked_plot_data.csv")

# Define color scheme
color_scheme = ['#feeece', '#ffa205', '#ff4500', '#08030a', '#5f0922', '#3d6469', '#d40637']

# Data processing
region_count = region_count['value'].value_counts().reset_index()
region_count.columns = ['region', 'count']
region_order = ['North America', 'South Asia', 'Europe & Central Asia', 'Latin America & Caribbean', 'Middle East & North Africa', 'East Asia & Pacific', 'Sub-Saharan Africa']
region_count['region'] = region_count['region'].replace([1, 2, 3, 4, 5, 6, 7], region_order)

overtime = overtime[overtime['Indicator Name'].isin(['Gross enrolment ratio, primary, female (%)', 'Gross enrolment ratio, secondary, female (%)', 'Gross enrolment ratio, tertiary, female (%)'])]
overtime['Indicator Name'] = overtime['Indicator Name'].replace({
    'Gross enrolment ratio, primary, female (%)': 'Gross_enrolment_ratio_primary_female_pct',
    'Gross enrolment ratio, secondary, female (%)': 'Gross_enrolment_ratio_secondary_female_pct',
    'Gross enrolment ratio, tertiary, female (%)': 'Gross_enrolment_ratio_tertiary_female_pct'
})

over_melted = overtime.melt(id_vars=['Country Name', 'Indicator Name'], var_name='Year', value_name='Value')
over_melted = over_melted[over_melted['Country Name'].isin(region_order)]

# Change 'Country Name' column name to 'region'
over_melted = over_melted.rename(columns={'Country Name': 'region'})

# Define selection
region_selection = alt.selection_point(fields=['region'], on='mouseover')

# Create bar chart for region counts with North America first
bar1 = alt.Chart(region_count).mark_bar().encode(
    x=alt.X('region:N', axis=alt.Axis(title="", labelAngle=-45), sort=region_order),  # Specify order of regions
    y=alt.Y('count:Q', axis=alt.Axis(title="Count")),
    color=alt.Color('region:N', scale=alt.Scale(range=color_scheme), title="Region"),
    opacity=alt.condition(region_selection, alt.value(1), alt.value(0.5))
).properties(
    title="Region Count",
    width=300,
    height=225
).add_params(
    region_selection
)

# Define function to create scatter plots
def create_scatter(melted_df, indicator, title, legend_position=None):
    scatter = alt.Chart(melted_df[melted_df['Indicator Name'] == indicator]).mark_circle(size=30).encode(
        x=alt.X('Year:Q', title="Year", scale=alt.Scale(domain=[1968, 2015]), axis=alt.Axis(format='d')),
        y=alt.Y('Value:Q', title="Ratio"),
        color=alt.Color('region', scale=alt.Scale(range=color_scheme), title="Region", legend=legend_position)
    ).properties(
        title=title,
        width=300,
        height=150
    ).transform_filter(
        region_selection
    )
    return scatter

# Create scatter plots
scatter1 = create_scatter(over_melted, 'Gross_enrolment_ratio_primary_female_pct', 'Female Enrollment Ratio, Primary')
scatter2 = create_scatter(over_melted, 'Gross_enrolment_ratio_secondary_female_pct', 'Female Enrollment Ratio, Secondary')
scatter3 = create_scatter(over_melted, 'Gross_enrolment_ratio_tertiary_female_pct', 'Female Enrollment Ratio, Tertiary', alt.Legend(orient='left'))

# Combine the charts
chart1 = alt.vconcat(bar1)
chart2 = alt.vconcat(scatter1, scatter2, scatter3)
final_chart = alt.hconcat(chart1, chart2).configure_title(fontSize=12)

final_chart
```

# Sources 

https://blogs.worldbank.org/en/opendata/new-world-bank-country-classifications-income-level-2022-2023

---
title: "Split Packed Bubble Plot"
author: "Jorge Bris Moreno"
format:
    html:
        embed-resources: true
        code-fold: true
        toc: true
        before_body: scripts.html
---

```{r, echo=FALSE, results='asis', runtime="js"}
# Calling highcharts
cat('
<script src="https://code.highcharts.com/maps/highmaps.js"></script>
<script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
<script src="https://code.highcharts.com/maps/modules/accessibility.js"></script>
')
```


```{ojs}
colorPalette = [
  [0, '#330f63'],    // dark blue-purple
  [0.1, '#481567'],  // deep purple
  [0.2, '#5f1868'],  // deep purple
  [0.3, '#76216b'],  // dark purple
  [0.4, '#8f2769'],  // dark purple-pink
  [0.5, '#ab3e5b'],  // purplish red
  [0.6, '#c7584c'],  // red-orange
  [0.7, '#e1793e'],  // orange
  [0.8, '#f5a234'],  // bright orange
  [0.9, '#f9c957'],  // yellow-orange
  [1, '#fcffa4']     // very light yellow
];

(async () => {
    let topology = await fetch('https://code.highcharts.com/mapdata/custom/world.topo.json')
       .then(response => response.json());

    // Data appears to be a constant structure so it can be declared with 'const'
    let data = [
  {
    "name": "ARB",
    "value": 93.608
  },
  {
    "name": "EAS",
    "value": 104.9668
  },
  {
    "name": "EAP",
    "value": 105.2243
  },
  {
    "name": "EMU",
    "value": 103.4798
  },
  {
    "name": "ECS",
    "value": 103.1583
  },
  {
    "name": "ECA",
    "value": 101.6871
  },
  {
    "name": "EUU",
    "value": 103.9449
  },
  {
    "name": "HPC",
    "value": 98.0805
  },
  {
    "name": "HIC",
    "value": 102.0787
  },
  {
    "name": "LCN",
    "value": 107.0963
  },
  {
    "name": "LAC",
    "value": 107.3809
  },
  {
    "name": "LDC",
    "value": 100.2302
  },
  {
    "name": "LMY",
    "value": 104.3708
  },
  {
    "name": "LIC",
    "value": 99.2115
  },
  {
    "name": "LMC",
    "value": 105.5588
  },
  {
    "name": "MEA",
    "value": 103.047
  },
  {
    "name": "MNA",
    "value": 102.4904
  },
  {
    "name": "MIC",
    "value": 105.0638
  },
  {
    "name": "NAC",
    "value": 99.3733
  },
  {
    "name": "OED",
    "value": 102.2592
  },
  {
    "name": "SAS",
    "value": 112.5074
  },
  {
    "name": "SSF",
    "value": 94.7694
  },
  {
    "name": "SSA",
    "value": 94.7689
  },
  {
    "name": "UMC",
    "value": 104.2601
  },
  {
    "name": "WLD",
    "value": 103.8494
  },
  {
    "name": "AFG",
    "value": 91.7579
  },
  {
    "name": "ALB",
    "value": 111.1673
  },
  {
    "name": "DZA",
    "value": 115.1333
  },
  {
    "name": "ATG",
    "value": 93.3092
  },
  {
    "name": "ARG",
    "value": 109.7614
  },
  {
    "name": "ABW",
    "value": 115.4297
  },
  {
    "name": "AUS",
    "value": 105.7587
  },
  {
    "name": "AUT",
    "value": 101.6984
  },
  {
    "name": "AZE",
    "value": 105.493
  },
  {
    "name": "BHR",
    "value": 100.456
  },
  {
    "name": "BRB",
    "value": 94.1669
  },
  {
    "name": "BLR",
    "value": 99.0571
  },
  {
    "name": "BEL",
    "value": 104.9222
  },
  {
    "name": "BLZ",
    "value": 108.95
  },
  {
    "name": "BEN",
    "value": 119.9226
  },
  {
    "name": "BMU",
    "value": 86.0617
  },
  {
    "name": "BTN",
    "value": 102.8738
  },
  {
    "name": "BOL",
    "value": 95.8438
  },
  {
    "name": "BWA",
    "value": 105.8012
  },
  {
    "name": "BRA",
    "value": 108.9931
  },
  {
    "name": "BRN",
    "value": 107.5561
  },
  {
    "name": "BGR",
    "value": 98.7499
  },
  {
    "name": "BFA",
    "value": 85.0913
  },
  {
    "name": "BDI",
    "value": 128.4259
  },
  {
    "name": "CPV",
    "value": 109.907
  },
  {
    "name": "KHM",
    "value": 113.1353
  },
  {
    "name": "CMR",
    "value": 106.885
  },
  {
    "name": "CHL",
    "value": 98.8515
  },
  {
    "name": "CHN",
    "value": 104.0123
  },
  {
    "name": "COL",
    "value": 111.7424
  },
  {
    "name": "COM",
    "value": 99.4594
  },
  {
    "name": "COD",
    "value": 101.8445
  },
  {
    "name": "CRI",
    "value": 110.286
  },
  {
    "name": "CIV",
    "value": 83.5878
  },
  {
    "name": "HRV",
    "value": 98.7139
  },
  {
    "name": "CUB",
    "value": 95.8327
  },
  {
    "name": "CYP",
    "value": 99.5871
  },
  {
    "name": "CZE",
    "value": 98.8783
  },
  {
    "name": "DNK",
    "value": 100.6596
  },
  {
    "name": "DJI",
    "value": 63.263
  },
  {
    "name": "DMA",
    "value": 117.9919
  },
  {
    "name": "DOM",
    "value": 95.7246
  },
  {
    "name": "ECU",
    "value": 113.4911
  },
  {
    "name": "EGY",
    "value": 103.7742
  },
  {
    "name": "SLV",
    "value": 109.7239
  },
  {
    "name": "ERI",
    "value": 47.1461
  },
  {
    "name": "EST",
    "value": 99.0226
  },
  {
    "name": "ETH",
    "value": 95.8226
  },
  {
    "name": "FIN",
    "value": 101.3999
  },
  {
    "name": "FRA",
    "value": 104.971
  },
  {
    "name": "GMB",
    "value": 90.8281
  },
  {
    "name": "GEO",
    "value": 117.5432
  },
  {
    "name": "DEU",
    "value": 102.9817
  },
  {
    "name": "GHA",
    "value": 106.4023
  },
  {
    "name": "GRC",
    "value": 97.1059
  },
  {
    "name": "GRD",
    "value": 102.2528
  },
  {
    "name": "GTM",
    "value": 101.5921
  },
  {
    "name": "GIN",
    "value": 83.7966
  },
  {
    "name": "HND",
    "value": 108.0323
  },
  {
    "name": "HUN",
    "value": 100.9149
  },
  {
    "name": "IND",
    "value": 114.0863
  },
  {
    "name": "IDN",
    "value": 104.4599
  },
  {
    "name": "IRN",
    "value": 111.5957
  },
  {
    "name": "IRL",
    "value": 102.5718
  },
  {
    "name": "ISR",
    "value": 104.3748
  },
  {
    "name": "ITA",
    "value": 101.0766
  },
  {
    "name": "JPN",
    "value": 101.1876
  },
  {
    "name": "JOR",
    "value": 97.6112
  },
  {
    "name": "KAZ",
    "value": 111.3404
  },
  {
    "name": "KEN",
    "value": 111.5768
  },
  {
    "name": "KIR",
    "value": 115.182
  },
  {
    "name": "KOR",
    "value": 98.5283
  },
  {
    "name": "KWT",
    "value": 103.025
  },
  {
    "name": "KGZ",
    "value": 107.0264
  },
  {
    "name": "LAO",
    "value": 113.4927
  },
  {
    "name": "LVA",
    "value": 99.9731
  },
  {
    "name": "LBN",
    "value": 89.9923
  },
  {
    "name": "LSO",
    "value": 105.8455
  },
  {
    "name": "LBR",
    "value": 91.59
  },
  {
    "name": "LIE",
    "value": 102.2556
  },
  {
    "name": "LTU",
    "value": 102.6071
  },
  {
    "name": "LUX",
    "value": 97.3323
  },
  {
    "name": "MAC",
    "value": 96.3242
  },
  {
    "name": "MKD",
    "value": 89.6473
  },
  {
    "name": "MDG",
    "value": 146.542
  },
  {
    "name": "MWI",
    "value": 147.9642
  },
  {
    "name": "MYS",
    "value": 102.905
  },
  {
    "name": "MLI",
    "value": 72.977
  },
  {
    "name": "MLT",
    "value": 102.7591
  },
  {
    "name": "MRT",
    "value": 100.6721
  },
  {
    "name": "MUS",
    "value": 103.7294
  },
  {
    "name": "MEX",
    "value": 103.1544
  },
  {
    "name": "FSM",
    "value": 97.1805
  },
  {
    "name": "MDA",
    "value": 92.8593
  },
  {
    "name": "MNG",
    "value": 100.6383
  },
  {
    "name": "MAR",
    "value": 113.3955
  },
  {
    "name": "MOZ",
    "value": 100.2787
  },
  {
    "name": "MMR",
    "value": 98.2936
  },
  {
    "name": "NRU",
    "value": 100.4011
  },
  {
    "name": "NPL",
    "value": 140.6295
  },
  {
    "name": "NLD",
    "value": 104.095
  },
  {
    "name": "NZL",
    "value": 98.4593
  },
  {
    "name": "NER",
    "value": 65.0248
  },
  {
    "name": "NOR",
    "value": 100.1206
  },
  {
    "name": "OMN",
    "value": 114.0607
  },
  {
    "name": "PAK",
    "value": 85.8102
  },
  {
    "name": "PLW",
    "value": 111.791
  },
  {
    "name": "PAN",
    "value": 100.8738
  },
  {
    "name": "PER",
    "value": 101.4283
  },
  {
    "name": "POL",
    "value": 100.6509
  },
  {
    "name": "PRT",
    "value": 106.1384
  },
  {
    "name": "PRI",
    "value": 90.4305
  },
  {
    "name": "QAT",
    "value": 100.7764
  },
  {
    "name": "RUS",
    "value": 98.9205
  },
  {
    "name": "RWA",
    "value": 135.1156
  },
  {
    "name": "WSM",
    "value": 106.2645
  },
  {
    "name": "STP",
    "value": 109.4119
  },
  {
    "name": "SAU",
    "value": 108.2517
  },
  {
    "name": "SEN",
    "value": 84.3095
  },
  {
    "name": "SRB",
    "value": 101.3633
  },
  {
    "name": "SYC",
    "value": 104.7033
  },
  {
    "name": "SVK",
    "value": 100.3733
  },
  {
    "name": "SVN",
    "value": 99.3749
  },
  {
    "name": "SLB",
    "value": 112.103
  },
  {
    "name": "ZAF",
    "value": 97.2689
  },
  {
    "name": "ESP",
    "value": 105.2732
  },
  {
    "name": "LKA",
    "value": 100.1062
  },
  {
    "name": "KNA",
    "value": 84.4902
  },
  {
    "name": "VCT",
    "value": 103.0432
  },
  {
    "name": "SUR",
    "value": 118.2731
  },
  {
    "name": "SWZ",
    "value": 107.951
  },
  {
    "name": "SWE",
    "value": 124.2636
  },
  {
    "name": "CHE",
    "value": 103.2725
  },
  {
    "name": "TJK",
    "value": 97.1398
  },
  {
    "name": "TZA",
    "value": 84.6786
  },
  {
    "name": "THA",
    "value": 104.0782
  },
  {
    "name": "TLS",
    "value": 136.047
  },
  {
    "name": "TGO",
    "value": 121.4028
  },
  {
    "name": "TON",
    "value": 107.465
  },
  {
    "name": "TUN",
    "value": 111.3951
  },
  {
    "name": "TUR",
    "value": 105.6009
  },
  {
    "name": "TKM",
    "value": 88.6385
  },
  {
    "name": "TUV",
    "value": 102.1212
  },
  {
    "name": "UKR",
    "value": 105.0629
  },
  {
    "name": "ARE",
    "value": 107.1077
  },
  {
    "name": "GBR",
    "value": 108.0794
  },
  {
    "name": "USA",
    "value": 99.2292
  },
  {
    "name": "URY",
    "value": 107.2961
  },
  {
    "name": "UZB",
    "value": 98.9494
  },
  {
    "name": "VEN",
    "value": 99.6989
  },
  {
    "name": "VNM",
    "value": 108.6183
  },
  {
    "name": "PSE",
    "value": 94.567
  }
];

 // Initialize the map chart with the topology and data
Highcharts.mapChart('container', {
chart: {
map: topology
},
title: {
text: 'Gross Enrolment Ratio in Primary Education (Female)',
align: 'left'
},
credits: {
href: '',
text: ''
},
mapNavigation: {
enabled: true,
buttonOptions: {
verticalAlign: 'bottom'
}
},
colorAxis: {
    min: 0,
    max: 100,
    type: 'linear',
    stops: colorPalette
  },
series: [{
  name: 'Gross Enrolment Ratio',
  joinBy: ['iso-a3', 'name'],
  data: data,
  dataLabels: {
    enabled: true,
    format: '{point.value:.1f}',
    style: {
      fontWeight: 'normal'
    }
  }
}]
});
})();
```

<div id="container"></div>
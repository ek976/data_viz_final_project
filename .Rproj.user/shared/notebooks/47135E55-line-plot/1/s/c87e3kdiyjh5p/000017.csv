"0",""
"0",""
"0","# Load the tidy data"
"0","# df <- read.csv('../data/tidy_data.csv')"
"0",""
"0","# Display the first few rows of the data frame"
"0","# print(head(df))"
"0",""
"0","# Select rows where the 'Series Name' column matches specific conditions"
"0","df <- read[((read$Indicator.Name == ""Labor force with advanced education, female (% of female labor force)"") | (read$Indicator.Name == ""Labor force with advanced education, male (% of male labor force)"") | (read$Indicator.Name == ""Labor force with basic education, female (% of female labor force)"") |"
"0","(read$Indicator.Name == ""Labor force with basic education, male (% of male labor force)"")),]"
"0","df <- na.omit(df)"
"0",""
"0","# Calculate average percentage by income group"
"0","df_avg <- aggregate(Value ~ Income_Group + Year + Indicator.Name, data = df, FUN = mean, na.rm = TRUE)"
"0",""
"0","# Filter for the years 2010 to 2013"
"0","df_avg <- df_avg[df_avg$Year >= 2010 & df_avg$Year <= 2013, ]"
"0",""
"0","# Filter for the year 2011 to use for labeling"
"0","df_label <- df_avg[df_avg$Year == 2011, ]"
"0",""
"0","tiana_palette <- c('#EFA9AE','#D29E08','#4C91D1','#E70E02','#6B892F',  '#332288')"
"0",""
"0","# Define the plot function"
"0","plot_fun <- function(df, df_label, title) {"
"0","  ggplot(df, aes(x = Year, y = Value, color = Income_Group)) +"
"0","    geom_line() +"
"0","    geom_text(data = df_label, aes(label = Income_Group),"
"0","              nudge_x = 0.25, nudge_y = 3, check_overlap = TRUE) +"
"0","    scale_color_manual(values = tiana_palette, name = ""Country"") +"
"0","    ylim(20, 100) + "
"0","    labs(title = title,"
"0","         x = ""Year"","
"0","         y = ""Percentage"") +"
"0","    theme(legend.position = ""none"")"
"0","}"
"0",""
"0","# Create facet_wrap plot"
"0","facet_plot <- ggplot(df_avg, aes(x = Year, y = Value, color = Income_Group)) +"
"0","  geom_line() +"
"0","  scale_color_manual(values = tiana_palette, name = ""Country"") +"
"0","  ylim(20, 100) +"
"0","  labs(title = ""Labor Force with Education Levels"","
"0","       x = ""Year"","
"0","       y = ""Percentage"") +"
"0","  facet_wrap(~Indicator.Name)"
"0",""
"0","print(facet_plot)"
"0",""
